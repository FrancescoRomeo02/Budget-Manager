<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Budget Manager</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">Budget Manager</a>
        </div>
    </nav>

    <div class="container mt-5">
        <!-- Titolo e Saldo -->
        <div class="text-center">
            <h1 class="display-4">Gestione Budget</h1>
            <p class="fs-4">
                Saldo attuale: 
                <span class="fw-bold" th:text="${#numbers.formatDecimal(saldo, 1, 2)}" 
                      th:classappend="${saldo < 0 ? 'text-danger' : 'text-success'}">0.00</span> €
            </p>
            <a href="/transactions/add" class="btn btn-success btn-lg">+ Aggiungi Transazione</a>
            <a href="/transactions" class="btn btn-primary btn-lg">Visualizza tutte le transazioni</a>
        </div>

        <!-- Messaggio di Avviso se il saldo è negativo -->
        <div th:if="${saldo < 0}" class="alert alert-danger mt-4 text-center" role="alert">
            ⚠️ Attenzione! Il tuo saldo è negativo.
        </div>

        <!-- Statistiche rapide -->
        <div class="row text-center mt-5">
            <div class="col-md-4">
                <div class="card border-success">
                    <div class="card-body">
                        <h5 class="card-title text-success">Entrate</h5>
                        <p class="fs-3 fw-bold text-success" th:text="${#numbers.formatDecimal(totaleEntrate, 1, 2)}">0.00</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card border-danger">
                    <div class="card-body">
                        <h5 class="card-title text-danger">Uscite</h5>
                        <p class="fs-3 fw-bold text-danger" th:text="${#numbers.formatDecimal(totaleUscite, 1, 2)}">0.00</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card" th:classappend="${saldo<=0 ? 'border-danger' : 'border-success'}">
                    <div class="card-body">
                        <h5 class="card-title">Saldo Netto</h5>
                        <p class="fs-3 fw-bold" th:text="${#numbers.formatDecimal(saldo, 1, 2)}" 
                           th:classappend="${saldo < 0 ? 'text-danger' : 'text-success'}">0.00</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ultime transazioni -->
        <h2 class="mt-5">Ultime Transazioni</h2>
        <table class="table table-striped mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Data</th>
                    <th>Categoria</th>
                    <th>Descrizione</th>
                    <th>Importo</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="transaction : ${ultimeTransazioni}">
                    <td th:text="${transaction.date}">01/01/2024</td>
                    <td th:text="${transaction.category}">Categoria</td>
                    <td th:text="${transaction.description}">Descrizione</td>
                    <td th:text="${#numbers.formatDecimal(transaction.amount, 1, 2)}" 
                        th:classappend="${transaction.type.name() == 'USCITA' ? 'text-danger' : 'text-success'}">
                        0.00
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(ultimeTransazioni)}">
                    <td colspan="4" class="text-center">Nessuna transazione disponibile</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>